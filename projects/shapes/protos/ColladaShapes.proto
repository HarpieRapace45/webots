#VRML_SIM R2022b utf8
# license: Copyright Cyberbotics Ltd. Licensed for use only with Webots.
# license url: https://cyberbotics.com/webots_assets_license
# This PROTO allows the Collada (.dae) files to be referenced.
# template language: javascript

PROTO ColladaShapes [
  field SFString  url  ""  # URL of a Collada file (similar to ImageTexture node).
  field SFVec3f  scale  1 1 1  # Resize the mesh by this possibly non-uniform scale. Negative values will mirror the mesh along according planes.
]
{
  %<
    let url = fields.url.value;
    if (!wbfile.fileExists(url)) {
      console.error(`The given Collada url (${url}) is not valid.`);
      url = fields.url.defaultValue;
    }

    let scale = fields.scale.value;
    if (scale.x == 0.0) {
      console.error(`All 'scale' coordinates must be not null: x is set to 1.0.`);
      scale.x = 1.0;
    }
    if (scale.y == 0.0) {
      console.error(`All 'scale' coordinates must be not null: y is set to 1.0.`);
      scale.y = 2.0;
    }
    if (scale.z == 0.0) {
      console.error(`All 'scale' coordinates must be not null: z is set to 1.0.`);
      scale.z = 1.0;
    }
    let scaleString = scale.x + ' ' + scale.y + ' ' + scale.z;
  >%

  Group {
    children [
      %< if (url !== '') { >%
        %<= wbcollada.getVrmlFromFile(url, scaleString) >%
      %< } >%
    ]
  }
}
